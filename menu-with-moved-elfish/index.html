<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="alternative" href="/atom.xml" title="I am Oliver" type="application/atom+xml"><link rel="icon" href="/favicon.png"><title>菜单下面的小精灵 - I am Oliver</title><link rel="stylesheet" href="/css/main.css"><!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]--></head><body><header class="head"><h1 class="head-title u-fl"><a href="/">I am Oliver</a></h1><nav class="head-nav u-fr"><ul class="head-nav__list"><li class="head-nav__item"><a href="/archives" class="head-nav__link">カタログ</a></li></ul></nav></header><main class="main"><article class="post"><header class="post__head"><time datetime="2016-03-21T08:05:51.000Z" class="post__time">March 21, 2016</time><h1 class="post__title"><a href="/menu-with-moved-elfish/">菜单下面的小精灵</a></h1><div class="post__main echo"><p>有些网站的导航下面会有一到杠，鼠标在各个导航之间移动的时候，这一道杠也会跟着动，很好看，就像这个</p>
<p></p><p data-height="268" data-theme-id="0" data-slug-hash="PNbGZQ" data-default-tab="result" data-user="ochukai" class="codepen">See the Pen <a href="http://codepen.io/ochukai/pen/PNbGZQ/" target="_blank" rel="external">ooo-nav</a> by Oliver (<a href="http://codepen.io/ochukai" target="_blank" rel="external">@ochukai</a>) on <a href="http://codepen.io" target="_blank" rel="external">CodePen</a>.</p><p></p>
<script async src="//assets.codepen.io/assets/embed/ei.js"></script>

<p>我把她叫做小精灵。</p>
<hr>
<h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>实现这个其实不难，当鼠标移动到某一个菜单上面时，小精灵滑入（至于方向，如果鼠标从右边进入菜单，那就从右向左滑），然后当鼠标移出时，小精灵跟着也移出菜单， 同时如果鼠标恰好移进了另一个菜单，下一个菜单的进入动画也开始播放，连续起来的话就像是小精灵跟着过来了。</p>
<h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><h3 id="菜单"><a href="#菜单" class="headerlink" title="菜单"></a>菜单</h3><p>菜单的话当然是用 ul 来实现了</p>
<pre><code class="html">&lt;ul class=&quot;nav&quot;&gt;
  &lt;li&gt;我的&lt;/li&gt;
  &lt;li&gt;导航栏&lt;/li&gt;
  &lt;li&gt;非常&lt;/li&gt;
  &lt;li&gt;牛逼&lt;/li&gt;
&lt;/ul&gt;
</code></pre>
<h3 id="小精灵"><a href="#小精灵" class="headerlink" title="小精灵"></a>小精灵</h3><p>这个小精灵该怎么实现呢, 开始时我打算用 <code>border</code> 来实现，试了一下之后才发现，并不理想，因为当鼠标 hover 时，border 变化，内容也会随着动，很丑。</p>
<p>于是我就想用 <code>after</code> 这个伪元素来实现，因为之前并没用过，感觉蛮新鲜的。</p>
<p>使用 <code>after</code> 最重要的地方也是前提，就是 <code>content: &#39;&#39;</code>，如果没有这一句，不管怎么修饰 <code>after</code> 的样式，都是徒劳。</p>
<p>写完之后的样子大概是这样</p>
<pre><code class="less">  &gt; li {
    float:left;
    display: inline-block;
    padding: 10px 20px;
    cursor: pointer;
    position: relative;
    overflow: hidden;

    &amp;:after {
      content: &#39;&#39;;
      height: 3px;
      position: absolute;
      bottom: 0;
    }
  }
</code></pre>
<h3 id="动画"><a href="#动画" class="headerlink" title="动画"></a>动画</h3><p>根据上面的原理，如果想实现的话，大概只需要写四个动画</p>
<ul>
<li>小精灵从右向左进入菜单</li>
<li>小精灵从右向左移出菜单</li>
<li>小精灵从左向右进入菜单</li>
<li>小精灵从左向右移出菜单</li>
</ul>
<p>我打算使用 <code>width</code> 的变化来模拟小精灵的滑动效果，假如是从左向右， css 就像下面这样：</p>
<pre><code class="css">@keyframes slide-in {
  from { width: 0; }
  to { width: 100%; }
}

.slide-in-from-left:after,
.slide-out-from-left:after {
  left: 0; // 初始位置在左边，宽度为 0，宽度逐渐变大
}

.slide-in-from-left:after,
.slide-in-from-right:after {
  animation-name: slide-in;
  animation-timing-function: cubic-bezier(0.65, 0.05, 0.36, 1);
}
</code></pre>
<h3 id="JS"><a href="#JS" class="headerlink" title="JS"></a>JS</h3><p>css 写完了，不过我要识别鼠标进入或离开的方向，也就是要判断鼠标是从左边进入还是从右边进入，是从左边移出还是从右边移出。</p>
<p>于是， 要写一些 js 来判断</p>
<pre><code class="js">$(function() {

  var classList = [
        &#39;slide-in-from-left&#39;,
        &#39;slide-in-from-right&#39;,
        &#39;slide-out-from-right&#39;,
        &#39;slide-out-from-left&#39;
      ].join(&#39; &#39;);

  $(&#39;ul.nav&#39;)
    .on(&#39;mouseenter&#39;, &#39;li&#39;, function(e) {
      var $this = $(this);
      var width = $this.outerWidth();
      var xx = e.offsetX;
      var className = (xx &lt; (width / 2))
                    ? &#39;slide-in-from-left&#39;
                    : &#39;slide-in-from-right&#39;;

      $this.removeClass(classList).addClass(className);      
    })
    .on(&#39;mouseleave&#39;, &#39;li&#39;, function(e) {
      var $this = $(this);
      var width = $this.outerWidth();
      var xx = e.offsetX;
      var className = (xx &lt; (width / 2))
                    ? &#39;slide-out-from-left&#39;
                    : &#39;slide-out-from-right&#39;;
      $this.removeClass(classList).addClass(className);
    });

});
</code></pre>
<p>这样就写完了，再把开头的例子放上吧。</p>
<p></p><p data-height="268" data-theme-id="0" data-slug-hash="PNbGZQ" data-default-tab="result" data-user="ochukai" class="codepen">See the Pen <a href="http://codepen.io/ochukai/pen/PNbGZQ/" target="_blank" rel="external">ooo-nav</a> by Oliver (<a href="http://codepen.io/ochukai" target="_blank" rel="external">@ochukai</a>) on <a href="http://codepen.io" target="_blank" rel="external">CodePen</a>.</p><p></p>
<script async src="//assets.codepen.io/assets/embed/ei.js"></script>

<p>谢谢。</p>
</div></header><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a href="/tags/nav/" class="post__tag__link">nav</a></li></ul></footer></article><div class="comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript></div></div></main><footer class="foot"><div class="foot-copy u-fl">&copy; 2017 Oliver Wang</div><menu class="page-menu u-fr"><li class="page-menu__item"><a title="Previous" href="/formdata-in-action/" class="page-menu__link icon-arrow-left"></a></li><li class="page-menu__item"><a title="Next" href="/css-animation-queue-list/" class="page-menu__link icon-arrow-right"></a></li></menu></footer><script>(function(h,g,l,k,j,i){j=h.createElement(g),i=h.getElementsByTagName(g)[0],j.src="//"+l+".disqus.com/"+k+".js",i.parentNode.insertBefore(j,i)})(document,"script","ochukai","embed");
</script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
ga('create','UA-73840162-1');
ga('send','pageview');
</script><script src="http://code.jquery.com/jquery-3.1.1.min.js"></script><script src="/js/main.js"></script></body></html>