!function(o,e,t,i){o.fn.modalBox=function(o,e){return s[o]?s[o].call(this,e):"object"!=typeof o&&o||s.open.call(this,o),this},o.modalBox={},o.modalBox.defaults={width:"auto",height:"auto",left:"auto",top:"auto",overlay:!0,iconClose:!1,keyClose:!0,bodyClose:!0,iconImg:"image/closeIcon.png",onOpen:function(){},onClose:function(){}},o.modalBox.close=function(){o(".iw-modalBox").each(function(){s.close.call(o(this))})};var a=function(e){var t=e.keyCode;27==t&&o.modalBox.close()},l=function(e){e.data?s.close.call(e.data.modalBox):o.modalBox.close()},d=function(t){var i=t.data.img,a=t.data.elm;i.css({top:a.offset().top-o(e).scrollTop()-8+"px",left:a.offset().left-o(e).scrollLeft()+a.width()-8+"px",position:"fixed","z-index":"99999"})},n=function(){o("body").append('<div class="iw-modalOverlay"></div>'),o(".iw-modalOverlay").css({display:"block",width:"100%",height:"100%",position:"fixed",top:0,left:0,"z-index":"1000"})},s={open:function(i){i=o.extend({},o.modalBox.defaults,i);var s=this,c=s.width(),h=s.height(),r=s.outerWidth(),m=s.outerHeight(),u=o(e).width(),f=o(e).height(),w=Math.min(r,u)-(r-c),g=Math.min(m,f)-(m-h);s.data("iw-size",{width:c,height:h}).addClass("iw-modalBox"),"auto"!=i.width?s.css("width",i.width):s.width(w),"auto"!=i.height?s.css("height",i.height):s.height(g);var p="50%",x="50%",v=s.outerWidth()/2,y=s.outerHeight()/2;if("auto"!=i.left&&(x=i.left,v="0"),"auto"!=i.top&&(p=i.top,y="0"),s.css({top:p,left:x,position:"fixed","margin-left":-v,"margin-top":-y,"z-index":"99999"}),s.fadeIn(300),i.overlay&&n(),i.iconClose&&s.outerWidth()<u-50&&s.outerHeight()<f-50){var B=Math.ceil(1e3*Math.random())+"close",b=o('<img src="'+i.iconImg+'" class="iw-closeImg" id="'+B+'"/>');s.attr("closeImg",B),b.bind("click",{modalBox:s},l),o(e).bind("resize.iw-modalBox",{img:b,elm:s},d),o(e).triggerHandler("resize.iw-modalBox"),o("body").append(b)}if(i.keyClose&&o(t).bind("keyup.iw-modalBox",a),i.bodyClose){var C=o(".iw-modalOverlay");0===C.length&&(n(),C=o(".iw-modalOverlay"),C.css({background:"none"})),C.bind("click",l)}i.onOpen.call(this),s.data("closeFun",i.onClose)},close:function(){var i=this;if(i.data("iw-size")){var a=i.attr("closeImg");i.fadeOut(100),a&&(i.removeAttr("closeImg"),o("#"+a).fadeOut().remove());var l=i.data("iw-size");i.width(l.width),i.height(l.height),i.data("closeFun").call(this),i.removeData("iw-size").removeData("closeFun").removeClass("iw-modalBox"),0===o(".iw-modalBox").length&&(o(".iw-modalOverlay").remove(),o(t).unbind("keyup.iw-modalBox"),o(e).unbind("resize.iw-modalBox"))}}}}(jQuery,window,document);